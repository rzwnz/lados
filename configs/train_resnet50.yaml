# Training configuration for ResNet50

# Data
data:
  root: "data/processed"
  train_manifest: "manifests/train.csv"
  val_manifest: "manifests/val.csv"
  test_manifest: "manifests/test.csv"
  img_size: 224
  num_workers: 4

# Model
model:
  backbone: "resnet50"
  num_classes: 6
  pretrained: true
  freeze_backbone: false  # Set to true for transfer learning phase 1

# Training
training:
  epochs: 50
  batch_size: 16  # Will be auto-tuned if batch_size_tuner enabled
  batch_size_tuner:
    enabled: true
    max_batch_size: 32
    min_batch_size: 4
  gradient_accumulation_steps: 2
  mixed_precision: true
  
  # Optimizer
  optimizer: "AdamW"
  lr: 3e-4  # For head training
  lr_finetune: 1e-5  # For full fine-tuning
  weight_decay: 1e-2
  
  # Scheduler
  scheduler: "cosine"
  warmup_epochs: 5
  warmup_steps: null  # Auto-computed if null
  
  # Early stopping
  early_stopping:
    enabled: true
    patience: 10
    metric: "val_macro_f1"
    mode: "max"
    min_delta: 0.001

# Output
output:
  run_dir: "runs"
  save_best_by: "val_macro_f1"
  export_formats: ["torchscript", "onnx"]

# Device
device:
  use_gpu: true
  cuda_device: 0

# Logging
logging:
  log_interval: 10
  save_interval: 1  # Save checkpoint every N epochs

# Small sample mode (for quick testing)
small_sample:
  enabled: false
  max_samples: 200

